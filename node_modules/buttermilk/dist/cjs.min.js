"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var PropTypes=_interopDefault(require("prop-types")),React=_interopDefault(require("react"));function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var liteUrl_min=createCommonjsModule(function(e,t){(function(){function r(e,t,r){var n=e.split(t);return r(n.shift(),n.join(t))}function n(e){var t={hash:"",host:"",hostname:"",origin:"",pathname:"",protocol:"",search:"",password:"",username:"",port:""};return r(e,"#",function(e,n){n&&(t.hash=n?"#"+n:""),r(e,"?",function(e,n){n&&(t.search="?"+n),e&&r(e,"//",function(e,n){t.protocol=e,r(n,"/",function(e,n){t.pathname="/"+(n||""),(t.protocol||e)&&(t.origin=t.protocol+"//"+e),r(e,"@",function(e,n){if(n){var o=e.split(":");t.username=o[0],t.password=o[1]}else n=e;t.host=n,r(n,":",function(e,r){t.hostname=e,r&&(t.port=r)})})})})})}),t.href=t.origin+t.pathname+t.search+t.hash,t}function o(e){var t={},r=e.search;if(r){var n=(r=r.replace(new RegExp("\\?"),"")).split("&");for(var o in n)if(n.hasOwnProperty(o)&&n[o]){var i=n[o].split("=");t[i[0]]=i[1]}}return t}function i(e){var t=a[e];return void 0!==t?t:((t=n(e)).params=o(t),a[e]=t,t)}var a={};return i.changeQueryParser=function(e){o=e},e.exports&&(t=e.exports=i),t.liteURL=i,i}).call(this)}),liteUrl_min_1=liteUrl_min.liteURL;function regexify(e){return new RegExp(e.replace(/([/.?+])/g,"\\$1").replace(/[.]{0}[*](?![*])/g,".*?/?").replace(/[/][.]{0}[*]{2}(?![*])/g,".*?").replace(/\\[?]/,".*?\\?.*?").replace(/\(([^)]+)\)/g,"(?:$1)?").replace(/\/:[^/()#?]*/g,"/([^/]*)")+"$")}var PATH_EXTRACTION_R=/:[^/?#()]*/g,isString=function(e){return"string"==typeof e};function extractParamsFromPath(e){return isString(e)?(e.match(PATH_EXTRACTION_R)||[]).map(function(e){return e.slice(1)}):[]}function getRouteParamsForURL(e,t){if(!e.params.length)return{};var r=t.match(e.test)||[];return r.length&&r.shift(),r.reduce(function(t,r,n){return t[e.params[n]]=r,t},{})}function processRoute(e){return Object.assign({},e,{params:extractParamsFromPath(e.path),test:isString(e.path)?regexify(e.path):e.path})}function valid(e,t){return e instanceof RegExp?e.test(t):e instanceof Function?e(t):void 0}function getRedirectUrl(e,t){if(e.includes("://"))return e;var r=new liteUrl_min(t);return r.protocol+"//"+r.host+e}function findRoute(e,t){var r=e.find(function(e){return valid(e.test,t)});if(r)return r.redirect?findRoute(e,getRedirectUrl(r.redirect,t)):{route:r,url:t};throw new Error("No valid routes were found for URL "+t+'. Did you forget to define a fallback "*" path?')}function parseUrl(e){var t=new liteUrl_min(e);return t.query=t.search.slice(1).split("&").reduce(function(e,t){if(t){var r=t.indexOf("=");e[t.slice(0,r)]=t.slice(r+1)}return e},{}),t}function createRouteContext(e,t){return{location:parseUrl(t),params:getRouteParamsForURL(e,t),route:e}}function match(e,t){var r=findRoute(e.map(processRoute),t),n=r.route,o=r.url,i=Object.assign({},createRouteContext(n,o));return o!==t&&(i.redirect=o),i}function route(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];history[t?"pushState":"replaceState"]({},"",e),window.dispatchEvent(new Event("popstate"))}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _React$createContext=React.createContext(),Provider=_React$createContext.Provider,Consumer=_React$createContext.Consumer,BROWSER="undefined"!=typeof window,NOOP=function(){},Router=function(e){function t(e,r){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));if(_initialiseProps.call(n),!BROWSER&&!e.url)throw new Error("props.url is required for non-browser environments");var o=n.processRoutes(e.routes),i=e.url||t.getURL();return n.state=n.getStateUpdateForUrl(i,o),e.routerDidInitialize(createRouteContext(n.state.activeRoute,i)),n}return _inherits(t,React.Component),_createClass(t,[{key:"shouldRecompute",value:function(e){return e.routes!==this.props.routes||e.url!==this.state.url&&!BROWSER}},{key:"componentWillReceiveProps",value:function(e){this.shouldRecompute(e)&&this.recomputeRoutingState(BROWSER?this.state.url:e.url,e.routes)}},{key:"componentDidMount",value:function(){window.addEventListener("popstate",this.handleLocationChange),window.addEventListener("hashchange",this.handleLocationChange)}},{key:"componentWillUpdate",value:function(){this.recomputeRoutingState}},{key:"componentWillUnmount",value:function(){window.removeEventListener("popstate",this.handleLocationChange),window.removeEventListener("hashchange",this.handleLocationChange)}},{key:"render",value:function(){var e=createRouteContext(this.state.activeRoute,this.state.url);return React.createElement(Provider,{value:e},React.createElement(this.props.outerComponent,e,this.renderChildren(this.state.children,e)))}},{key:"renderChildren",value:function(e,t){return null===e?React.createElement(this.props.loadingComponent,t):React.isValidElement(e)?e:React.createElement(e,t)}},{key:"processChildren",value:function(e){if(e instanceof Promise){var t=this;return t.promise=e,e.then(function(e){t.promise===this&&(t.setState({children:e}),this.promise=null)}.bind(e),NOOP),null}return e}},{key:"processRoutes",value:function(e){return e.map(processRoute)}},{key:"getStateUpdateForUrl",value:function(e,t){var r=findRoute(t,e);return{activeRoute:r.route,children:this.processChildren(r.route.render(createRouteContext(r.route,r.url))),routes:t,url:r.url}}}]),t}();Router.propTypes={loadingComponent:PropTypes.oneOfType([PropTypes.func,PropTypes.string]),outerComponent:PropTypes.oneOfType([PropTypes.func,PropTypes.string]),routes:PropTypes.arrayOf(PropTypes.shape({path:PropTypes.oneOfType([PropTypes.instanceOf(RegExp),PropTypes.string,PropTypes.func]).isRequired,redirect:PropTypes.string,render:PropTypes.func})).isRequired,routeWillChange:PropTypes.func,routeDidChange:PropTypes.func,routerDidInitialize:PropTypes.func,url:PropTypes.string},Router.defaultProps={loadingComponent:"div",outerComponent:"div",routeDidChange:NOOP,routeWillChange:NOOP,routerDidInitialize:NOOP,url:""},Router.getURL=function(){return window.location.href};var _initialiseProps=function(){var e=this;this.noFallbackWarningEmitted=!1,this.promise=null,this.handleLocationChange=function(){var t=createRouteContext(e.state.activeRoute,e.state.url),r=findRoute(e.state.routes,Router.getURL()),n=r.route,o=r.url,i=createRouteContext(n,o),a=e.props.routeWillChange(t,i),s=function(){return e.props.routeDidChange(i,t)},u=function(){return e.recomputeRoutingState(o,e.state.routes,s)};!1!==a&&(a instanceof Promise?a.then(u,NOOP):u())},this.recomputeRoutingState=function(t,r,n){e.setState(e.getStateUpdateForUrl(t,r===e.state.routes?r:e.processRoutes(r)),n)}},RoutingState=Consumer,Link=function(e){function t(){var e,r,n;_classCallCheck(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return r=n=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.handleNavigationIntent=function(e){"keydown"===e.type&&("keydown"!==e.type||"Enter"!==e.key&&"Space"!==e.key)||(e.preventDefault(),e.stopPropagation(),e.metaKey||"_blank"===e.target.getAttribute("target")?window.open(n.props.href):route(n.props.href))},_possibleConstructorReturn(n,r)}return _inherits(t,React.PureComponent),_createClass(t,[{key:"render",value:function(){var e=this;return React.createElement(Consumer,null,function(t){var r=t.route;return React.createElement(e.props.as,Object.assign({},e.props,{"data-active":valid(r.test,e.props.href)?"":void 0,as:void 0,href:e.shouldRenderAnchorProps()?e.props.href:void 0,role:e.shouldRenderRole()?"link":void 0,onClick:e.handleNavigationIntent,onKeyDown:e.handleNavigationIntent,onTouchEnd:e.handleNavigationIntent,target:e.shouldRenderAnchorProps()?e.props.target:void 0}))})}},{key:"shouldRenderAnchorProps",value:function(){return this.props.as===t.defaultProps.as||"string"!=typeof this.props.as}},{key:"shouldRenderRole",value:function(){return this.props.as!==t.defaultProps.as}}]),t}();Link.propTypes={as:PropTypes.oneOfType([PropTypes.func,PropTypes.string]),href:PropTypes.string.isRequired,target:PropTypes.string},Link.defaultProps={as:"a"},exports.match=match,exports.route=route,exports.Router=Router,exports.RoutingState=RoutingState,exports.Link=Link;
//# sourceMappingURL=cjs.min.js.map
